# config ディレクトリのカスタムルール

本書は `config/categories_seed.txt` と `config/category_rules.json` を編集する際の目的と書式、推奨ルールをまとめたものです。アプリケーションがカテゴリ候補を生成・分類する際の基礎データとなるため、変更内容は慎重に管理してください。

## `categories_seed.txt`

### 役割
- アプリ初回起動時に表示される既定カテゴリのリストです。
- 1 行につき 1 カテゴリ名を記載し、上から順に UI へ読み込まれます。
- ファイルが存在しない場合はアプリが既定値で自動生成しますが、手動で編集した内容は上書きされません。

### 記載ルール
1. **文字コード**: UTF-8 (BOM なし) を使用してください。
2. **改行**: UNIX 改行 (LF)。
3. **フォーマット**: 余計な空白やタブを行頭・行末に入れないでください。
4. **重複禁止**: カテゴリ名が重複すると UI 上で重複表示され、分類結果も不安定になります。
5. **管理メモ**: コメント行はサポートされていないため、メモは別途ドキュメントに残してください。

### 編集ガイド
- 新しいカテゴリを追加する際は、`category_rules.json` に対応するルールも必ず用意してください。
- 既存カテゴリを削除・改名する場合は、JSON 側のキー名と照合し整合性を保ちます。
- 並び順は UI の表示順に直結するため、利用頻度や重要度を考慮して並べ替えます。

## `category_rules.json`

### 役割
- 各カテゴリに紐づくキーワードルール (Strong/Weak/Anti) を定義する JSON ファイルです。
- アプリはテキストを分類する際に、本ファイルのルールをもとにスコアリングを行います。
- ファイルが存在しない場合、`internal/app/hybrid.go` に定義された既定ルールで自動生成されます。

### 構造
```json
{
  "カテゴリ名": {
    "Strong": ["必須級キーワード1", "必須級キーワード2"],
    "Weak": ["補助キーワード1", "補助キーワード2"],
    "Anti": ["除外キーワード1"]
  },
  "別カテゴリ": { ... }
}
```
- **Strong**: カテゴリを強く示唆する語。出現すると高いスコア加点。
- **Weak**: 関連はあるが曖昧な語。Strong より加点は小さいため、多めに登録しても問題ありません。
- **Anti**: 出現するとスコアを減点し、誤分類を防ぎます。不要な場合は空配列にするか、省略せず `[]` を指定してください。

### 記載ルール
1. **JSON 構文**: シンタックスエラーを防ぐため、必ず整形式の JSON にしてください (末尾カンマ禁止など)。
2. **文字列**: 文字列はダブルクォートで囲み、UTF-8 (BOM なし) を使用します。
3. **カテゴリ名**: `categories_seed.txt` に記載した名前と完全一致させます。異なる場合、そのカテゴリは読み込まれません。
4. **配列**: キーワード配列は必要に応じて空配列 `[]` を指定します。`null` は使用しないでください。
5. **重複・前後空白**: 同一語の重複や前後空白は避け、語尾の全角・半角を確認してください。
6. **バージョン管理**: 変更前後で diff を確認し、必要に応じてレビューを受けてください。

### 編集ガイド
- **新規カテゴリ**: `categories_seed.txt` に追記したら、同名キーを JSON に追加し、Strong/Weak/Anti を最低 1 配列ずつ定義します (空配列可)。
- **キーワード選定**:
  - Strong にはカテゴリを代表する専門用語や固有名詞を登録します。
  - Weak には関連する一般語や派生語を広く登録し、語尾の揺れ (例: "化"/"化する") をカバーします。
  - Anti には、名前は似ているが意味が異なる領域や避けたいユースケースの語を入れます。
- **メンテナンス**: 誤分類が発生した場合はログを確認し、Strong/Weak/Anti のバランスを見直します。
- **テスト**: 変更後はアプリを起動し、代表的な文書で推論結果を確認してください。

## 運用ヒント
- 変更履歴を追跡しやすいよう、カテゴリの追加・削除時はコミットメッセージに対象カテゴリを明記します。
- 大規模な更新を行う前にバックアップ (コピー) を作成し、問題があればすぐに戻せるようにしておきます。
- 複数人で編集する場合は、編集前に最新ブランチを取得し、コンフリクトが発生しないよう調整してください。

以上のルールに従うことで、カテゴリ分類の精度と保守性を維持できます。
